import{_ as s,o as a,c as n,f as l}from"./app-fb7f4aba.js";const p={},o=l(`<h1 id="_7-解析-url-参数" tabindex="-1"><a class="header-anchor" href="#_7-解析-url-参数" aria-hidden="true">#</a> 7. 解析 URL 参数</h1><p>解析 URL 中的参数列表。</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="shiki dark-plus" style="background-color:#1E1E1E;" tabindex="0"><code><span class="line"><span style="color:#569CD6;">function</span><span style="color:#D4D4D4;"> </span><span style="color:#DCDCAA;">parseParam</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">url</span><span style="color:#D4D4D4;">) {</span></span>
<span class="line"><span style="color:#D4D4D4;">  </span><span style="color:#569CD6;">const</span><span style="color:#D4D4D4;"> </span><span style="color:#4FC1FF;">paramsStr</span><span style="color:#D4D4D4;"> =</span><span style="color:#D16969;"> /.</span><span style="color:#D7BA7D;">+\\?</span><span style="color:#CE9178;">(</span><span style="color:#D16969;">.</span><span style="color:#D7BA7D;">+</span><span style="color:#CE9178;">)</span><span style="color:#DCDCAA;">$</span><span style="color:#D16969;">/</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">exec</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">url</span><span style="color:#D4D4D4;">)[</span><span style="color:#B5CEA8;">1</span><span style="color:#D4D4D4;">]; </span><span style="color:#6A9955;">// 将 ? 后面的字符串取出来</span></span>
<span class="line"><span style="color:#D4D4D4;">  </span><span style="color:#569CD6;">const</span><span style="color:#D4D4D4;"> </span><span style="color:#4FC1FF;">paramsArr</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">paramsStr</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">split</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;&amp;&#39;</span><span style="color:#D4D4D4;">); </span><span style="color:#6A9955;">// 将字符串以 &amp; 分割后存到数组中</span></span>
<span class="line"><span style="color:#D4D4D4;">  </span><span style="color:#569CD6;">const</span><span style="color:#D4D4D4;"> </span><span style="color:#4FC1FF;">paramsObj</span><span style="color:#D4D4D4;"> = {};</span></span>
<span class="line"><span style="color:#D4D4D4;">  </span><span style="color:#6A9955;">// 将 params 存到对象中</span></span>
<span class="line"><span style="color:#D4D4D4;">  </span><span style="color:#9CDCFE;">paramsArr</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">forEach</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">param</span><span style="color:#D4D4D4;"> </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#C586C0;">if</span><span style="color:#D4D4D4;"> (</span><span style="color:#D16969;">/=/</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">test</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">param</span><span style="color:#D4D4D4;">)) { </span><span style="color:#6A9955;">// 处理有 value 的参数</span></span>
<span class="line"><span style="color:#D4D4D4;">      </span><span style="color:#569CD6;">const</span><span style="color:#D4D4D4;"> [</span><span style="color:#4FC1FF;">key</span><span style="color:#D4D4D4;">, </span><span style="color:#4FC1FF;">val_encoded</span><span style="color:#D4D4D4;">] = </span><span style="color:#9CDCFE;">param</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">split</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;=&#39;</span><span style="color:#D4D4D4;">); </span><span style="color:#6A9955;">// 分割 key 和 value</span></span>
<span class="line"><span style="color:#D4D4D4;">      </span><span style="color:#569CD6;">const</span><span style="color:#D4D4D4;"> </span><span style="color:#4FC1FF;">val_decoded</span><span style="color:#D4D4D4;"> = </span><span style="color:#DCDCAA;">decodeURIComponent</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">val_encoded</span><span style="color:#D4D4D4;">); </span><span style="color:#6A9955;">// 解码</span></span>
<span class="line"><span style="color:#D4D4D4;">      </span><span style="color:#569CD6;">const</span><span style="color:#D4D4D4;"> </span><span style="color:#4FC1FF;">val</span><span style="color:#D4D4D4;"> =</span><span style="color:#D16969;"> /</span><span style="color:#DCDCAA;">^</span><span style="color:#D16969;">\\d</span><span style="color:#D7BA7D;">+</span><span style="color:#DCDCAA;">$</span><span style="color:#D16969;">/</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">test</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">val</span><span style="color:#D4D4D4;">) ? </span><span style="color:#DCDCAA;">parseFloat</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">val_decoded</span><span style="color:#D4D4D4;">) : </span><span style="color:#9CDCFE;">val_decoded</span><span style="color:#D4D4D4;">; </span><span style="color:#6A9955;">// 判断是否转为数字</span></span>
<span class="line"><span style="color:#D4D4D4;">      </span><span style="color:#C586C0;">if</span><span style="color:#D4D4D4;"> (</span><span style="color:#9CDCFE;">paramsObj</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">hasOwnProperty</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">key</span><span style="color:#D4D4D4;">)) { </span><span style="color:#6A9955;">// 如果对象有 key，则添加一个值</span></span>
<span class="line"><span style="color:#D4D4D4;">        </span><span style="color:#9CDCFE;">paramsObj</span><span style="color:#D4D4D4;">[</span><span style="color:#9CDCFE;">key</span><span style="color:#D4D4D4;">].</span><span style="color:#DCDCAA;">push</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">val</span><span style="color:#D4D4D4;">);</span></span>
<span class="line"><span style="color:#D4D4D4;">      } </span><span style="color:#C586C0;">else</span><span style="color:#D4D4D4;"> { </span><span style="color:#6A9955;">// 如果对象没有这个 key，创建 key 并设置值</span></span>
<span class="line"><span style="color:#D4D4D4;">        </span><span style="color:#9CDCFE;">paramsObj</span><span style="color:#D4D4D4;">[</span><span style="color:#9CDCFE;">key</span><span style="color:#D4D4D4;">] = </span><span style="color:#9CDCFE;">val</span><span style="color:#D4D4D4;">;</span></span>
<span class="line"><span style="color:#D4D4D4;">      }</span></span>
<span class="line"><span style="color:#D4D4D4;">    } </span><span style="color:#C586C0;">else</span><span style="color:#D4D4D4;"> { </span><span style="color:#6A9955;">// 处理没有 value 的参数</span></span>
<span class="line"><span style="color:#D4D4D4;">      </span><span style="color:#9CDCFE;">paramsObj</span><span style="color:#D4D4D4;">[</span><span style="color:#9CDCFE;">param</span><span style="color:#D4D4D4;">] = </span><span style="color:#569CD6;">true</span><span style="color:#D4D4D4;">;</span></span>
<span class="line"><span style="color:#D4D4D4;">    }</span></span>
<span class="line"><span style="color:#D4D4D4;">  })</span></span>
<span class="line"><span style="color:#D4D4D4;">  </span><span style="color:#C586C0;">return</span><span style="color:#D4D4D4;"> </span><span style="color:#9CDCFE;">paramsObj</span><span style="color:#D4D4D4;">;</span></span>
<span class="line"><span style="color:#D4D4D4;">}</span></span>
<span class="line"></span></code></pre><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><br><br><div class="highlight-line"> </div><br><br><br><br><br><br><br><br><br></div><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>修改了原文的代码，转换为更简单的移入操作，并全部使用 <code>const</code> 定义变量。</p><div class="language-diff" data-ext="diff"><pre class="shiki dark-plus" style="background-color:#1E1E1E;" tabindex="0"><code><span class="line"><span style="color:#B5CEA8;">+ paramsObj[key].push(val);</span></span>
<span class="line"><span style="color:#CE9178;">- paramsObj[key] = [].concat(paramsObj[key], val);</span></span>
<span class="line"></span></code></pre></div>`,5),e=[o];function D(r,c){return a(),n("div",null,e)}const y=s(p,[["render",D],["__file","07-parse-url-param.html.vue"]]);export{y as default};
