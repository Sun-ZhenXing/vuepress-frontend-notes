import{_ as s}from"./plugin-vue_export-helper-DlAUqK2U.js";import{o as n,c as a,d as l}from"./app-FEcl1joV.js";const o={},p=l(`<h1 id="9-图片懒加载" tabindex="-1"><a class="header-anchor" href="#9-图片懒加载"><span>9. 图片懒加载</span></a></h1><p>图片懒加载的优化处理：</p><ul><li>图片全部加载完成后移除事件监；</li><li>加载完的图片，从 <code>imgList</code> 移除</li></ul><p>图片使用 <code>data-src</code> 而不是 <code>src</code> 保存 URL，当滚动到指定位置时显示图片。</p><div class="language-javascript" data-ext="js" data-title="js"><pre class="shiki dark-plus" style="background-color:#1E1E1E;color:#D4D4D4;" tabindex="0"><code><span class="line"><span style="color:#569CD6;">let</span><span style="color:#9CDCFE;"> imgList</span><span style="color:#D4D4D4;"> = [...</span><span style="color:#9CDCFE;">document</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">querySelectorAll</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;img&#39;</span><span style="color:#D4D4D4;">)]</span></span>
<span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> length</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">imgList</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">length</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> imgLazyLoad</span><span style="color:#D4D4D4;"> = (() </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span>
<span class="line"><span style="color:#569CD6;">  let</span><span style="color:#9CDCFE;"> count</span><span style="color:#D4D4D4;"> = </span><span style="color:#B5CEA8;">0</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C586C0;">  return</span><span style="color:#D4D4D4;"> () </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span>
<span class="line"><span style="color:#569CD6;">    const</span><span style="color:#4FC1FF;"> deleteIndexList</span><span style="color:#D4D4D4;"> = []</span></span>
<span class="line"><span style="color:#9CDCFE;">    imgList</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">forEach</span><span style="color:#D4D4D4;">((</span><span style="color:#9CDCFE;">img</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">index</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span>
<span class="line"><span style="color:#569CD6;">      const</span><span style="color:#4FC1FF;"> rect</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">img</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">getBoundingClientRect</span><span style="color:#D4D4D4;">()</span></span>
<span class="line"><span style="color:#C586C0;">      if</span><span style="color:#D4D4D4;"> (</span><span style="color:#9CDCFE;">rect</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">top</span><span style="color:#D4D4D4;"> &lt; </span><span style="color:#9CDCFE;">window</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">innerHeight</span><span style="color:#D4D4D4;">) {</span></span>
<span class="line"><span style="color:#9CDCFE;">        img</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">src</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">img</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">dataset</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">src</span></span>
<span class="line"><span style="color:#9CDCFE;">        deleteIndexList</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">push</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">index</span><span style="color:#D4D4D4;">)</span></span>
<span class="line"><span style="color:#9CDCFE;">        count</span><span style="color:#D4D4D4;">++</span></span>
<span class="line"><span style="color:#C586C0;">        if</span><span style="color:#D4D4D4;"> (</span><span style="color:#9CDCFE;">count</span><span style="color:#D4D4D4;"> === </span><span style="color:#9CDCFE;">length</span><span style="color:#D4D4D4;">)</span></span>
<span class="line"><span style="color:#9CDCFE;">          document</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">removeEventListener</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;scroll&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">imgLazyLoad</span><span style="color:#D4D4D4;">)</span></span>
<span class="line"><span style="color:#D4D4D4;">      }</span></span>
<span class="line"><span style="color:#D4D4D4;">    })</span></span>
<span class="line"><span style="color:#9CDCFE;">    imgList</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">imgList</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">filter</span><span style="color:#D4D4D4;">((</span><span style="color:#9CDCFE;">img</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">index</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> !</span><span style="color:#9CDCFE;">deleteIndexList</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">includes</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">index</span><span style="color:#D4D4D4;">))</span></span>
<span class="line"><span style="color:#D4D4D4;">  }</span></span>
<span class="line"><span style="color:#D4D4D4;">})()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A9955;">// 这里最好加上防抖处理</span></span>
<span class="line"><span style="color:#9CDCFE;">document</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">addEventListener</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;scroll&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">imgLazyLoad</span><span style="color:#D4D4D4;">)</span></span>
<span class="line"></span></code></pre></div>`,5),e=[p];function t(D,c){return n(),a("div",null,e)}const i=s(o,[["render",t],["__file","09-image-lazyload.html.vue"]]),C=JSON.parse('{"path":"/notebook/js/handwrite-36/09-image-lazyload.html","title":"9. 图片懒加载","lang":"zh-CN","frontmatter":{"description":"9. 图片懒加载 图片懒加载的优化处理： 图片全部加载完成后移除事件监； 加载完的图片，从 imgList 移除 图片使用 data-src 而不是 src 保存 URL，当滚动到指定位置时显示图片。","head":[["meta",{"property":"og:url","content":"https://blog.alexsun.top/vuepress-frontend-notes/vuepress-frontend-notes/notebook/js/handwrite-36/09-image-lazyload.html"}],["meta",{"property":"og:site_name","content":"前端笔记"}],["meta",{"property":"og:title","content":"9. 图片懒加载"}],["meta",{"property":"og:description","content":"9. 图片懒加载 图片懒加载的优化处理： 图片全部加载完成后移除事件监； 加载完的图片，从 imgList 移除 图片使用 data-src 而不是 src 保存 URL，当滚动到指定位置时显示图片。"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-05-04T11:44:04.000Z"}],["meta",{"property":"article:author","content":"鸭梨"}],["meta",{"property":"article:modified_time","content":"2024-05-04T11:44:04.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"9. 图片懒加载\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2024-05-04T11:44:04.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"鸭梨\\",\\"url\\":\\"https://blog.alexsun.top/\\"}]}"]]},"headers":[],"git":{"createdTime":1675939447000,"updatedTime":1714823044000,"contributors":[{"name":"Sun-ZhenXing","email":"1006925066@qq.com","commits":1}]},"readingTime":{"minutes":0.24,"words":72},"filePathRelative":"notebook/js/handwrite-36/09-image-lazyload.md","localizedDate":"2023年2月9日","autoDesc":true}');export{i as comp,C as data};
