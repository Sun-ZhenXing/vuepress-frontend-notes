import{_ as c}from"./plugin-vue_export-helper-DlAUqK2U.js";import{r as l,o as u,c as i,b as n,a as s,w as o,e as t,d as p}from"./app-C-lF8Tfs.js";const r={},d=n("h1",{id:"nuxt3-常见问题总结",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#nuxt3-常见问题总结"},[n("span",null,"Nuxt3 常见问题总结")])],-1),h={class:"table-of-contents"},k=p('<h2 id="1-内部-bug" tabindex="-1"><a class="header-anchor" href="#1-内部-bug"><span>1. 内部 BUG</span></a></h2><h3 id="11-远程调试无法使用" tabindex="-1"><a class="header-anchor" href="#11-远程调试无法使用"><span>1.1 远程调试无法使用</span></a></h3><p>在手机上连接不到调试服务器，显示连接 <code>ws://localhost:4000</code> 错误。</p><div class="hint-container tip"><p class="hint-container-title">手机调试</p><p>推荐手机使用 Kiwi Browser，这个浏览器可以使用 Chrome 插件，还可以使用原生的开发者工具。</p></div>',4),x={href:"https://github.com/nuxt/nuxt/issues/15417",target:"_blank",rel:"noopener noreferrer"},g={class:"hint-container details"},_=n("summary",null,"已解决问题",-1),m=n("h3",{id:"快速触发导航导致-vue-渲染错误已解决",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#快速触发导航导致-vue-渲染错误已解决"},[n("span",null,[n("s",null,"快速触发导航导致 Vue 渲染错误"),t("（已解决）")])])],-1),f={href:"https://github.com/nuxt/nuxt/issues/13350",target:"_blank",rel:"noopener noreferrer"},v={href:"https://github.com/vuejs/core/issues/8105",target:"_blank",rel:"noopener noreferrer"},b=n("code",null,"<Suspense />",-1),N=n("code",null,"<Suspense />",-1),y=n("p",null,"临时解决方法：",-1),w=n("li",null,"禁用过渡动画",-1),q={href:"https://github.com/nuxt/nuxt/issues/13350#issuecomment-1543968330",target:"_blank",rel:"noopener noreferrer"},S=n("li",null,"监听全局错误然后强制刷新，参见下面的代码，体验很差",-1),B=p(`<div class="language-typescript" data-ext="ts" data-title="ts"><pre class="language-typescript"><code><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">import</span><span class="token punctuation">.</span>meta<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">SSR</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 当出现渲染错误时，自动刷新页面</span>
  window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;error&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>event<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>event<span class="token punctuation">.</span>message<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token string">&#39;insertBefore&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      event<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      window<span class="token punctuation">.</span>location<span class="token punctuation">.</span><span class="token function">reload</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>还有一种方法，可以临时解决此问题，不过可能导致过渡行为间歇性失效，原因未知。</p><div class="language-vue" data-ext="vue" data-title="vue"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>nuxt-layout</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Transition</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>page<span class="token punctuation">&quot;</span></span> <span class="token attr-name">mode</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>out-in<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">:key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>$route.fullPath<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>nuxt-page</span> <span class="token punctuation">/&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Transition</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>nuxt-layout</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h3 id="dev-过慢已解决" tabindex="-1"><a class="header-anchor" href="#dev-过慢已解决"><span><s>dev 过慢</s>（已解决）</span></a></h3><p>更新后发现，Windows 下 <code>dev</code> 比 <code>build</code> 还慢，一直在执行 Nitro built，等了好几分钟才出来。</p>`,5),T={href:"https://github.com/nuxt/nuxt/issues/20990",target:"_blank",rel:"noopener noreferrer"},V=n("h3",{id:"如何调试-errorvue已解决",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#如何调试-errorvue已解决"},[n("span",null,[n("s",null,[t("如何调试 "),n("code",null,"error.vue")]),t("（已解决）")])])],-1),D=n("p",null,[t("放弃调试了，这个页面如果有 "),n("code",null,"[...slug].vue"),t("，那么这个页面显示不了，如果没有，那么调试的时候显示源代码，有点混乱。")],-1),j=n("p",null,"最简单的办法是故意写错一段代码，然后这个页面就能正常渲染了（即错误页面确实只在错误的时候被正确渲染，但如果错误页面都错误了 Nuxt 就真的不知道干什么了）。",-1),E=p(`<h2 id="2-常规问题" tabindex="-1"><a class="header-anchor" href="#2-常规问题"><span>2. 常规问题</span></a></h2><h3 id="21-类型异常" tabindex="-1"><a class="header-anchor" href="#21-类型异常"><span>2.1 类型异常</span></a></h3><p>总是跳出莫名其妙的类型错误。</p><p>可能的解决方法：</p><ol><li>重新运行 <code>pnpm i</code></li><li>VS Code 命令面板：<strong>TypeScript: 重载项目</strong> 或者 <strong>TypeScript: 重启 TS 服务器</strong></li></ol><p>如果 <code>server/tsconfig.json</code> 提示 <strong>无法写入文件 XXX，因为它会覆盖输入文件。</strong>，可以尝试下面的方法。</p><p>将出现问题的文件的路径添加到 <code>exclude</code> 中，使用 glob 语法描述路径：</p><div class="language-json" data-ext="json" data-title="json"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;extends&quot;</span><span class="token operator">:</span> <span class="token string">&quot;../.nuxt/tsconfig.server.json&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;exclude&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token string">&quot;../eslint.config.*&quot;</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="22-部分依赖加载太慢或无法使用" tabindex="-1"><a class="header-anchor" href="#22-部分依赖加载太慢或无法使用"><span>2.2 部分依赖加载太慢或无法使用</span></a></h3><p>注意很多 <code>@nuxtjs/</code> 下的依赖都是仅适用于 Nuxt 2 的，但也有例外，而且有很多是 Alpha/Beta 版本，不稳定也不完整。</p><p>为什么我的 Pinia 无法持久化？安装这个 <code>@pinia-plugin-persistedstate/nuxt</code> 然后再看看文档。</p><h3 id="23-如何使用-axios" tabindex="-1"><a class="header-anchor" href="#23-如何使用-axios"><span>2.3 如何使用 Axios</span></a></h3><p>不要用，Axios 在 Nuxt 3 中被废除了，Axios 有报告在 SSR 中出现内存泄漏，所以也别用了。新的 API 代替就行了。</p><h2 id="3-总结" tabindex="-1"><a class="header-anchor" href="#3-总结"><span>3. 总结</span></a></h2><ul><li>使用 <code>import.meta.env.SSR</code> 判断是否为 SSR 环境</li><li>使用 <code>process.env.NODE_ENV === &#39;development&#39;</code> 判断是否为开发环境</li><li>使用 <code>process.env.NODE_ENV === &#39;production&#39;</code> 判断是否为生产环境</li><li>可以在 <code>nuxt.config.ts</code> 中使用 <code>runtimeConfig.public</code> 指定特殊变量 <ul><li>如 <code>buildTime: Date.now()</code> 表示打包时间</li><li>如 <code>version: require(&#39;./package.json&#39;).version</code> 表示版本号</li></ul></li></ul><h3 id="如何用-nuxt-写一个-nuxt-文档已过时" tabindex="-1"><a class="header-anchor" href="#如何用-nuxt-写一个-nuxt-文档已过时"><span><s>如何用 Nuxt 写一个 Nuxt 文档</s>（已过时）</span></a></h3><p>Nuxt 的文档显然是 Nuxt 做的，但是官方 GitHub 里面没有一个配置文件是和这个文档有关的，只有格式化 MarkDown，而且这个 MarkDown 格式很怪。</p>`,17),A={href:"https://github.com/nuxt/nuxt/tree/main/docs",target:"_blank",rel:"noopener noreferrer"},C={href:"http://nuxt.com",target:"_blank",rel:"noopener noreferrer"},P={href:"https://docus.dev/",target:"_blank",rel:"noopener noreferrer"},G=n("p",null,"其实这个生态并不如 VuePress，很多插件配置很痛苦而且不完整，建议使用 VuePress/VitePress 写文档。",-1),R=n("blockquote",null,[n("p",null,"不要把 VuePress 2 项目放在 Nuxt 项目下，编译报错，无法解决。应该是 Node 包导入机制的问题，这些包有许多冲突。")],-1);function M(U,X){const a=l("router-link"),e=l("ExternalLinkIcon");return u(),i("div",null,[d,n("nav",h,[n("ul",null,[n("li",null,[s(a,{to:"#1-内部-bug"},{default:o(()=>[t("1. 内部 BUG")]),_:1}),n("ul",null,[n("li",null,[s(a,{to:"#11-远程调试无法使用"},{default:o(()=>[t("1.1 远程调试无法使用")]),_:1})])])]),n("li",null,[s(a,{to:"#2-常规问题"},{default:o(()=>[t("2. 常规问题")]),_:1}),n("ul",null,[n("li",null,[s(a,{to:"#21-类型异常"},{default:o(()=>[t("2.1 类型异常")]),_:1})]),n("li",null,[s(a,{to:"#22-部分依赖加载太慢或无法使用"},{default:o(()=>[t("2.2 部分依赖加载太慢或无法使用")]),_:1})]),n("li",null,[s(a,{to:"#23-如何使用-axios"},{default:o(()=>[t("2.3 如何使用 Axios")]),_:1})])])]),n("li",null,[s(a,{to:"#3-总结"},{default:o(()=>[t("3. 总结")]),_:1}),n("ul",null,[n("li",null,[s(a,{to:"#如何用-nuxt-写一个-nuxt-文档已过时"},{default:o(()=>[t("如何用 Nuxt 写一个 Nuxt 文档（已过时）")]),_:1})])])])])]),k,n("p",null,[t("无法解决，见 "),n("a",x,[t("nuxt/nuxt#15417"),s(e)]),t(" 有曲线救国的办法，具体见问题，太复杂了没有尝试。")]),n("details",g,[_,m,n("p",null,[t("参见 "),n("a",f,[t("nuxt/nuxt#13350"),s(e)]),t("，此问题想了很久没有办法解决。")]),n("p",null,[t("此问题可以追溯到 "),n("a",v,[t("vue/core#8105"),s(e)]),t("，是 Vue 的实验性特征 "),b,t(" 导致的，而 Nuxt 的过渡动画是使用 "),N,t(" 实现的，所以无法解决。")]),y,n("ol",null,[w,n("li",null,[t("阻止过快触发导航，"),n("a",q,[t("这一点我已经提出来了"),s(e)]),t("，但是不能解决 100% 的问题，因此需要配合方法 3")]),S]),B,n("p",null,[t("解决不了，见 "),n("a",T,[t("nuxt/nuxt#20990"),s(e)]),t("，以上所有方法均无效，直接回滚版本吧。初步猜测是 Nuxt 依赖的 Nitro 依赖的 Rollup 依赖的 Babel 导致的，暂未解决。")]),V,D,j]),E,n("p",null,[t("因为官方还没把文档的源码放上去，那个 MarkDown 文件只是临时给你提交的。"),n("a",A,[t("官方说了"),s(e)]),t("：")]),n("blockquote",null,[n("p",null,[t("You can contribute directly on GitHub for now, we are planning to open source "),n("a",C,[t("nuxt.com"),s(e)]),t(" repo for everyone to contribute with ease very soon.")])]),n("p",null,[t("所以其实 Nuxt 的文档是 "),n("a",P,[t("Docus"),s(e)]),t(" 做的，你可以做一个差不多的 Nuxt 文档。")]),G,R])}const I=c(r,[["render",M],["__file","index.html.vue"]]),K=JSON.parse('{"path":"/nuxt/notes/","title":"Nuxt3 常见问题总结","lang":"zh-CN","frontmatter":{"description":"Nuxt3 常见问题总结 1. 内部 BUG 1.1 远程调试无法使用 在手机上连接不到调试服务器，显示连接 ws://localhost:4000 错误。 手机调试 推荐手机使用 Kiwi Browser，这个浏览器可以使用 Chrome 插件，还可以使用原生的开发者工具。 无法解决，见 nuxt/nuxt#15417 有曲线救国的办法，具体见问题，...","head":[["meta",{"property":"og:url","content":"https://blog.alexsun.top/vuepress-frontend-notes/vuepress-frontend-notes/nuxt/notes/"}],["meta",{"property":"og:site_name","content":"前端笔记"}],["meta",{"property":"og:title","content":"Nuxt3 常见问题总结"}],["meta",{"property":"og:description","content":"Nuxt3 常见问题总结 1. 内部 BUG 1.1 远程调试无法使用 在手机上连接不到调试服务器，显示连接 ws://localhost:4000 错误。 手机调试 推荐手机使用 Kiwi Browser，这个浏览器可以使用 Chrome 插件，还可以使用原生的开发者工具。 无法解决，见 nuxt/nuxt#15417 有曲线救国的办法，具体见问题，..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-05-05T01:44:53.000Z"}],["meta",{"property":"article:author","content":"鸭梨"}],["meta",{"property":"article:modified_time","content":"2024-05-05T01:44:53.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Nuxt3 常见问题总结\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2024-05-05T01:44:53.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"鸭梨\\",\\"url\\":\\"https://blog.alexsun.top/\\"}]}"]]},"headers":[{"level":2,"title":"1. 内部 BUG","slug":"1-内部-bug","link":"#1-内部-bug","children":[{"level":3,"title":"1.1 远程调试无法使用","slug":"11-远程调试无法使用","link":"#11-远程调试无法使用","children":[]}]},{"level":2,"title":"2. 常规问题","slug":"2-常规问题","link":"#2-常规问题","children":[{"level":3,"title":"2.1 类型异常","slug":"21-类型异常","link":"#21-类型异常","children":[]},{"level":3,"title":"2.2 部分依赖加载太慢或无法使用","slug":"22-部分依赖加载太慢或无法使用","link":"#22-部分依赖加载太慢或无法使用","children":[]},{"level":3,"title":"2.3 如何使用 Axios","slug":"23-如何使用-axios","link":"#23-如何使用-axios","children":[]}]},{"level":2,"title":"3. 总结","slug":"3-总结","link":"#3-总结","children":[{"level":3,"title":"如何用 Nuxt 写一个 Nuxt 文档（已过时）","slug":"如何用-nuxt-写一个-nuxt-文档已过时","link":"#如何用-nuxt-写一个-nuxt-文档已过时","children":[]}]}],"git":{"createdTime":1684835340000,"updatedTime":1714873493000,"contributors":[{"name":"Sun-ZhenXing","email":"1006925066@qq.com","commits":1}]},"readingTime":{"minutes":3.66,"words":1099},"filePathRelative":"nuxt/notes/README.md","localizedDate":"2023年5月23日","autoDesc":true}');export{I as comp,K as data};
