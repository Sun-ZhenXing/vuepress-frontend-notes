import{_ as r}from"./plugin-vue_export-helper-DlAUqK2U.js";import{r as p,o as c,c as i,b as s,a as e,w as t,e as n,d as a}from"./app-FEcl1joV.js";const u={},d=s("h1",{id:"nuxt3-常见问题总结",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#nuxt3-常见问题总结"},[s("span",null,"Nuxt3 常见问题总结")])],-1),D={class:"table-of-contents"},h=a('<h2 id="1-内部-bug" tabindex="-1"><a class="header-anchor" href="#1-内部-bug"><span>1. 内部 BUG</span></a></h2><h3 id="11-远程调试无法使用" tabindex="-1"><a class="header-anchor" href="#11-远程调试无法使用"><span>1.1 远程调试无法使用</span></a></h3><p>在手机上连接不到调试服务器，显示连接 <code>ws://localhost:4000</code> 错误。</p><div class="hint-container tip"><p class="hint-container-title">手机调试</p><p>推荐手机使用 Kiwi Browser，这个浏览器可以使用 Chrome 插件，还可以使用原生的开发者工具。</p></div>',4),y={href:"https://github.com/nuxt/nuxt/issues/15417",target:"_blank",rel:"noopener noreferrer"},x={class:"hint-container details"},_=s("summary",null,"已解决问题",-1),g=s("h3",{id:"快速触发导航导致-vue-渲染错误已解决",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#快速触发导航导致-vue-渲染错误已解决"},[s("span",null,[s("s",null,"快速触发导航导致 Vue 渲染错误"),n("（已解决）")])])],-1),C={href:"https://github.com/nuxt/nuxt/issues/13350",target:"_blank",rel:"noopener noreferrer"},m={href:"https://github.com/vuejs/core/issues/8105",target:"_blank",rel:"noopener noreferrer"},f=s("code",null,"<Suspense />",-1),v=s("code",null,"<Suspense />",-1),b=s("p",null,"临时解决方法：",-1),E=s("li",null,"禁用过渡动画",-1),k={href:"https://github.com/nuxt/nuxt/issues/13350#issuecomment-1543968330",target:"_blank",rel:"noopener noreferrer"},N=s("li",null,"监听全局错误然后强制刷新，参见下面的代码，体验很差",-1),w=a(`<div class="language-typescript" data-ext="ts" data-title="ts"><pre class="shiki dark-plus" style="background-color:#1E1E1E;color:#D4D4D4;" tabindex="0"><code><span class="line"><span style="color:#C586C0;">if</span><span style="color:#D4D4D4;"> (!</span><span style="color:#C586C0;">import</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">meta</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">env</span><span style="color:#D4D4D4;">.</span><span style="color:#4FC1FF;">SSR</span><span style="color:#D4D4D4;">) {</span></span>
<span class="line"><span style="color:#6A9955;">  // 当出现渲染错误时，自动刷新页面</span></span>
<span class="line"><span style="color:#9CDCFE;">  window</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">addEventListener</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;error&#39;</span><span style="color:#D4D4D4;">, (</span><span style="color:#9CDCFE;">event</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span>
<span class="line"><span style="color:#C586C0;">    if</span><span style="color:#D4D4D4;"> (</span><span style="color:#9CDCFE;">event</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">message</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">includes</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;insertBefore&#39;</span><span style="color:#D4D4D4;">)) {</span></span>
<span class="line"><span style="color:#9CDCFE;">      event</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">preventDefault</span><span style="color:#D4D4D4;">()</span></span>
<span class="line"><span style="color:#9CDCFE;">      window</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">location</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">reload</span><span style="color:#D4D4D4;">()</span></span>
<span class="line"><span style="color:#D4D4D4;">    }</span></span>
<span class="line"><span style="color:#D4D4D4;">  })</span></span>
<span class="line"><span style="color:#D4D4D4;">}</span></span>
<span class="line"></span></code></pre></div><p>还有一种方法，可以临时解决此问题，不过可能导致过渡行为间歇性失效，原因未知。</p><div class="language-vue" data-ext="vue" data-title="vue"><pre class="shiki dark-plus" style="background-color:#1E1E1E;color:#D4D4D4;" tabindex="0"><code><span class="line"><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">template</span><span style="color:#808080;">&gt;</span></span>
<span class="line"><span style="color:#808080;">  &lt;</span><span style="color:#569CD6;">nuxt-layout</span><span style="color:#808080;">&gt;</span></span>
<span class="line"><span style="color:#808080;">    &lt;</span><span style="color:#569CD6;">Transition</span><span style="color:#9CDCFE;"> name</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">&quot;page&quot;</span><span style="color:#9CDCFE;"> mode</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">&quot;out-in&quot;</span><span style="color:#808080;">&gt;</span></span>
<span class="line"><span style="color:#808080;">      &lt;</span><span style="color:#569CD6;">div</span><span style="color:#D4D4D4;"> :</span><span style="color:#9CDCFE;">key</span><span style="color:#D4D4D4;">=</span><span style="color:#D4D4D4;">&quot;</span><span style="color:#9CDCFE;">$route</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">fullPath</span><span style="color:#D4D4D4;">&quot;</span><span style="color:#808080;">&gt;</span></span>
<span class="line"><span style="color:#808080;">        &lt;</span><span style="color:#569CD6;">nuxt-page</span><span style="color:#808080;"> /&gt;</span></span>
<span class="line"><span style="color:#808080;">      &lt;/</span><span style="color:#569CD6;">div</span><span style="color:#808080;">&gt;</span></span>
<span class="line"><span style="color:#808080;">    &lt;/</span><span style="color:#569CD6;">Transition</span><span style="color:#808080;">&gt;</span></span>
<span class="line"><span style="color:#808080;">  &lt;/</span><span style="color:#569CD6;">nuxt-layout</span><span style="color:#808080;">&gt;</span></span>
<span class="line"><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">template</span><span style="color:#808080;">&gt;</span></span>
<span class="line"></span></code></pre></div><h3 id="dev-过慢已解决" tabindex="-1"><a class="header-anchor" href="#dev-过慢已解决"><span><s>dev 过慢</s>（已解决）</span></a></h3><p>更新后发现，Windows 下 <code>dev</code> 比 <code>build</code> 还慢，一直在执行 Nitro built，等了好几分钟才出来。</p>`,5),q={href:"https://github.com/nuxt/nuxt/issues/20990",target:"_blank",rel:"noopener noreferrer"},F=s("h3",{id:"如何调试-errorvue已解决",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#如何调试-errorvue已解决"},[s("span",null,[s("s",null,[n("如何调试 "),s("code",null,"error.vue")]),n("（已解决）")])])],-1),A=s("p",null,[n("放弃调试了，这个页面如果有 "),s("code",null,"[...slug].vue"),n("，那么这个页面显示不了，如果没有，那么调试的时候显示源代码，有点混乱。")],-1),S=s("p",null,"最简单的办法是故意写错一段代码，然后这个页面就能正常渲染了（即错误页面确实只在错误的时候被正确渲染，但如果错误页面都错误了 Nuxt 就真的不知道干什么了）。",-1),B=a(`<h2 id="2-常规问题" tabindex="-1"><a class="header-anchor" href="#2-常规问题"><span>2. 常规问题</span></a></h2><h3 id="21-类型异常" tabindex="-1"><a class="header-anchor" href="#21-类型异常"><span>2.1 类型异常</span></a></h3><p>总是跳出莫名其妙的类型错误。</p><p>可能的解决方法：</p><ol><li>重新运行 <code>pnpm i</code></li><li>VS Code 命令面板：<strong>TypeScript: 重载项目</strong> 或者 <strong>TypeScript: 重启 TS 服务器</strong></li></ol><p>如果 <code>server/tsconfig.json</code> 提示 <strong>无法写入文件 XXX，因为它会覆盖输入文件。</strong>，可以尝试下面的方法。</p><p>将出现问题的文件的路径添加到 <code>exclude</code> 中，使用 glob 语法描述路径：</p><div class="language-json" data-ext="json" data-title="json"><pre class="shiki dark-plus" style="background-color:#1E1E1E;color:#D4D4D4;" tabindex="0"><code><span class="line"><span style="color:#D4D4D4;">{</span></span>
<span class="line"><span style="color:#9CDCFE;">  &quot;extends&quot;</span><span style="color:#D4D4D4;">: </span><span style="color:#CE9178;">&quot;../.nuxt/tsconfig.server.json&quot;</span><span style="color:#D4D4D4;">,</span></span>
<span class="line"><span style="color:#9CDCFE;">  &quot;exclude&quot;</span><span style="color:#D4D4D4;">: [</span></span>
<span class="line"><span style="color:#CE9178;">    &quot;../eslint.config.*&quot;</span></span>
<span class="line"><span style="color:#D4D4D4;">  ]</span></span>
<span class="line"><span style="color:#D4D4D4;">}</span></span>
<span class="line"></span></code></pre></div><h3 id="22-部分依赖加载太慢或无法使用" tabindex="-1"><a class="header-anchor" href="#22-部分依赖加载太慢或无法使用"><span>2.2 部分依赖加载太慢或无法使用</span></a></h3><p>注意很多 <code>@nuxtjs/</code> 下的依赖都是仅适用于 Nuxt 2 的，但也有例外，而且有很多是 Alpha/Beta 版本，不稳定也不完整。</p><p>为什么我的 Pinia 无法持久化？安装这个 <code>@pinia-plugin-persistedstate/nuxt</code> 然后再看看文档。</p><h3 id="23-如何使用-axios" tabindex="-1"><a class="header-anchor" href="#23-如何使用-axios"><span>2.3 如何使用 Axios</span></a></h3><p>不要用，Axios 在 Nuxt 3 中被废除了，Axios 有报告在 SSR 中出现内存泄漏，所以也别用了。新的 API 代替就行了。</p><h2 id="3-总结" tabindex="-1"><a class="header-anchor" href="#3-总结"><span>3. 总结</span></a></h2><ul><li>使用 <code>import.meta.env.SSR</code> 判断是否为 SSR 环境</li><li>使用 <code>process.env.NODE_ENV === &#39;development&#39;</code> 判断是否为开发环境</li><li>使用 <code>process.env.NODE_ENV === &#39;production&#39;</code> 判断是否为生产环境</li><li>可以在 <code>nuxt.config.ts</code> 中使用 <code>runtimeConfig.public</code> 指定特殊变量 <ul><li>如 <code>buildTime: Date.now()</code> 表示打包时间</li><li>如 <code>version: require(&#39;./package.json&#39;).version</code> 表示版本号</li></ul></li></ul><h3 id="如何用-nuxt-写一个-nuxt-文档已过时" tabindex="-1"><a class="header-anchor" href="#如何用-nuxt-写一个-nuxt-文档已过时"><span><s>如何用 Nuxt 写一个 Nuxt 文档</s>（已过时）</span></a></h3><p>Nuxt 的文档显然是 Nuxt 做的，但是官方 GitHub 里面没有一个配置文件是和这个文档有关的，只有格式化 MarkDown，而且这个 MarkDown 格式很怪。</p>`,17),T={href:"https://github.com/nuxt/nuxt/tree/main/docs",target:"_blank",rel:"noopener noreferrer"},V={href:"http://nuxt.com",target:"_blank",rel:"noopener noreferrer"},j={href:"https://docus.dev/",target:"_blank",rel:"noopener noreferrer"},P=s("p",null,"其实这个生态并不如 VuePress，很多插件配置很痛苦而且不完整，建议使用 VuePress/VitePress 写文档。",-1),G=s("blockquote",null,[s("p",null,"不要把 VuePress 2 项目放在 Nuxt 项目下，编译报错，无法解决。应该是 Node 包导入机制的问题，这些包有许多冲突。")],-1);function R(M,U){const o=p("router-link"),l=p("ExternalLinkIcon");return c(),i("div",null,[d,s("nav",D,[s("ul",null,[s("li",null,[e(o,{to:"#1-内部-bug"},{default:t(()=>[n("1. 内部 BUG")]),_:1}),s("ul",null,[s("li",null,[e(o,{to:"#11-远程调试无法使用"},{default:t(()=>[n("1.1 远程调试无法使用")]),_:1})])])]),s("li",null,[e(o,{to:"#2-常规问题"},{default:t(()=>[n("2. 常规问题")]),_:1}),s("ul",null,[s("li",null,[e(o,{to:"#21-类型异常"},{default:t(()=>[n("2.1 类型异常")]),_:1})]),s("li",null,[e(o,{to:"#22-部分依赖加载太慢或无法使用"},{default:t(()=>[n("2.2 部分依赖加载太慢或无法使用")]),_:1})]),s("li",null,[e(o,{to:"#23-如何使用-axios"},{default:t(()=>[n("2.3 如何使用 Axios")]),_:1})])])]),s("li",null,[e(o,{to:"#3-总结"},{default:t(()=>[n("3. 总结")]),_:1}),s("ul",null,[s("li",null,[e(o,{to:"#如何用-nuxt-写一个-nuxt-文档已过时"},{default:t(()=>[n("如何用 Nuxt 写一个 Nuxt 文档（已过时）")]),_:1})])])])])]),h,s("p",null,[n("无法解决，见 "),s("a",y,[n("nuxt/nuxt#15417"),e(l)]),n(" 有曲线救国的办法，具体见问题，太复杂了没有尝试。")]),s("details",x,[_,g,s("p",null,[n("参见 "),s("a",C,[n("nuxt/nuxt#13350"),e(l)]),n("，此问题想了很久没有办法解决。")]),s("p",null,[n("此问题可以追溯到 "),s("a",m,[n("vue/core#8105"),e(l)]),n("，是 Vue 的实验性特征 "),f,n(" 导致的，而 Nuxt 的过渡动画是使用 "),v,n(" 实现的，所以无法解决。")]),b,s("ol",null,[E,s("li",null,[n("阻止过快触发导航，"),s("a",k,[n("这一点我已经提出来了"),e(l)]),n("，但是不能解决 100% 的问题，因此需要配合方法 3")]),N]),w,s("p",null,[n("解决不了，见 "),s("a",q,[n("nuxt/nuxt#20990"),e(l)]),n("，以上所有方法均无效，直接回滚版本吧。初步猜测是 Nuxt 依赖的 Nitro 依赖的 Rollup 依赖的 Babel 导致的，暂未解决。")]),F,A,S]),B,s("p",null,[n("因为官方还没把文档的源码放上去，那个 MarkDown 文件只是临时给你提交的。"),s("a",T,[n("官方说了"),e(l)]),n("：")]),s("blockquote",null,[s("p",null,[n("You can contribute directly on GitHub for now, we are planning to open source "),s("a",V,[n("nuxt.com"),e(l)]),n(" repo for everyone to contribute with ease very soon.")])]),s("p",null,[n("所以其实 Nuxt 的文档是 "),s("a",j,[n("Docus"),e(l)]),n(" 做的，你可以做一个差不多的 Nuxt 文档。")]),P,G])}const z=r(u,[["render",R],["__file","index.html.vue"]]),I=JSON.parse('{"path":"/nuxt/notes/","title":"Nuxt3 常见问题总结","lang":"zh-CN","frontmatter":{"description":"Nuxt3 常见问题总结 1. 内部 BUG 1.1 远程调试无法使用 在手机上连接不到调试服务器，显示连接 ws://localhost:4000 错误。 手机调试 推荐手机使用 Kiwi Browser，这个浏览器可以使用 Chrome 插件，还可以使用原生的开发者工具。 无法解决，见 nuxt/nuxt#15417 有曲线救国的办法，具体见问题，...","head":[["meta",{"property":"og:url","content":"https://blog.alexsun.top/vuepress-frontend-notes/vuepress-frontend-notes/nuxt/notes/"}],["meta",{"property":"og:site_name","content":"前端笔记"}],["meta",{"property":"og:title","content":"Nuxt3 常见问题总结"}],["meta",{"property":"og:description","content":"Nuxt3 常见问题总结 1. 内部 BUG 1.1 远程调试无法使用 在手机上连接不到调试服务器，显示连接 ws://localhost:4000 错误。 手机调试 推荐手机使用 Kiwi Browser，这个浏览器可以使用 Chrome 插件，还可以使用原生的开发者工具。 无法解决，见 nuxt/nuxt#15417 有曲线救国的办法，具体见问题，..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-05-05T01:44:53.000Z"}],["meta",{"property":"article:author","content":"鸭梨"}],["meta",{"property":"article:modified_time","content":"2024-05-05T01:44:53.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Nuxt3 常见问题总结\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2024-05-05T01:44:53.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"鸭梨\\",\\"url\\":\\"https://blog.alexsun.top/\\"}]}"]]},"headers":[{"level":2,"title":"1. 内部 BUG","slug":"1-内部-bug","link":"#1-内部-bug","children":[{"level":3,"title":"1.1 远程调试无法使用","slug":"11-远程调试无法使用","link":"#11-远程调试无法使用","children":[]}]},{"level":2,"title":"2. 常规问题","slug":"2-常规问题","link":"#2-常规问题","children":[{"level":3,"title":"2.1 类型异常","slug":"21-类型异常","link":"#21-类型异常","children":[]},{"level":3,"title":"2.2 部分依赖加载太慢或无法使用","slug":"22-部分依赖加载太慢或无法使用","link":"#22-部分依赖加载太慢或无法使用","children":[]},{"level":3,"title":"2.3 如何使用 Axios","slug":"23-如何使用-axios","link":"#23-如何使用-axios","children":[]}]},{"level":2,"title":"3. 总结","slug":"3-总结","link":"#3-总结","children":[{"level":3,"title":"如何用 Nuxt 写一个 Nuxt 文档（已过时）","slug":"如何用-nuxt-写一个-nuxt-文档已过时","link":"#如何用-nuxt-写一个-nuxt-文档已过时","children":[]}]}],"git":{"createdTime":1684835340000,"updatedTime":1714873493000,"contributors":[{"name":"Sun-ZhenXing","email":"1006925066@qq.com","commits":1}]},"readingTime":{"minutes":3.66,"words":1099},"filePathRelative":"nuxt/notes/README.md","localizedDate":"2023年5月23日","autoDesc":true}');export{z as comp,I as data};
